# docker-compose configuration
services:
  tool-node:
    image: ${image_name}
    container_name: ${image_name}
    hostname: ${image_name}
    networks:
      - workflow-net
    healthcheck:
      test: timeout 5s bash -c ':> /dev/tcp/127.0.0.1/8061' || exit 1
      interval: 1s
      timeout: 2s
      retries: 100
    volumes:
      - "${inputs}:/inputs:ro"
      - "${results}:/results"
  orchestrator:
    image: mock-orch
    container_name: mock-orchestrator
    hostname: mock-orchestrator
    environment:
      TOOL_HOSTNAME: "${image_name}"
      TOOL_FUNC: "mean_absolute_calibration_error"
      INPUT_URI_LIST: "/inputs/predictions.arrow,/inputs/labels.arrow,/inputs/config_A.json"
      OUTPUT_URI_LIST: "/results/result.arrow"
    networks:
      - workflow-net
    depends_on:
      tool-node:
        condition: service_healthy
    volumes:
      - "${inputs}:/inputs:ro"
      - "${results}:/results"

networks:
  workflow-net:
